# -*- coding: utf-8 -*-
"""CRUD Operations on Sales Dataset .ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Jhx392jKnwp6DTsWpQOF8vZpMh_gtxUb
"""

from csv import writer, reader
import pandas as pd
import os

# CREATE: Insert new records into the CSV file
def create_csv():
    with open('sales.csv', 'w', newline='') as file:
        csv_writer = writer(file, lineterminator='\n')
        header = ['Transaction ID', 'Product Name', 'Quantity', 'Price']
        data = [
            (1, 'Laptop', 2, 1500),
            (2, 'Headphones', 5, 300),
            (3, 'Phone', 1, 800)
        ]
        # Writing header and data
        csv_writer.writerow(header)
        csv_writer.writerows(data)
    print("Records have been created in 'sales.csv'.\n")


# READ: Retrieve and display records from the CSV file
def read_csv():
    if os.path.exists('sales.csv'):
        print("\nReading data from 'sales.csv':\n")
        with open('sales.csv', 'r') as file:
            csv_reader = reader(file)
            header = next(csv_reader)  # Skip header
            print(f"{header}")
            for row in csv_reader:
                print(row)
    else:
        print("The file 'sales.csv' does not exist. Please create it first using the CREATE operation.\n")


# UPDATE: Modify existing records in the CSV file
def update_csv(transaction_id, updated_data):
    if os.path.exists('sales.csv'):
        data = pd.read_csv('sales.csv')
        # Update the row where the Transaction ID matches
        data.loc[data['Transaction ID'] == transaction_id, ['Product Name', 'Quantity', 'Price']] = updated_data
        data.to_csv('sales.csv', index=False)
        print(f"Record with Transaction ID {transaction_id} has been updated.\n")
    else:
        print("The file 'sales.csv' does not exist. Please create it first using the CREATE operation.\n")


# DELETE: Remove specific records from the CSV file
def delete_csv(transaction_id):
    if os.path.exists('sales.csv'):
        data = pd.read_csv('sales.csv')
        # Delete the row where the Transaction ID matches
        data = data[data['Transaction ID'] != transaction_id]
        data.to_csv('sales.csv', index=False)
        print(f"Record with Transaction ID {transaction_id} has been deleted.\n")
    else:
        print("The file 'sales.csv' does not exist. Please create it first using the CREATE operation.\n")


# Run all operations
def run_crud_operations():
    # CREATE: Insert records
    create_csv()

    # READ: Display records
    read_csv()

    # UPDATE: Update a record (Example: Updating transaction ID 2)
    update_csv(2, ['Headset', 6, 350])

    # READ again to see the updates
    read_csv()

    # DELETE: Delete a record (Example: Deleting transaction ID 3)
    delete_csv(3)

    # READ again to see the changes after deletion
    read_csv()


# Running the CRUD operations
run_crud_operations()



